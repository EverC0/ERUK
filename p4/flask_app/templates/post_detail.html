{% extends "header.html" %} 
{% block content %}
<div class="container mx-auto px-4 py-8 max-w-4xl">
  {% if error %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4" role="alert">
      <p>{{ error }}</p>
    </div>
  {% endif %}
  
  <!-- Post details -->
  <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
    <div class="p-6">
      <div class="flex items-center mb-4">
        {% if author_pic %}
          <img src="data:image/png;base64,{{ author_pic }}" class="w-12 h-12 rounded-full mr-4">
        {% endif %}
        <div>
          <a href="{{ url_for('posts.user_detail', username=post.author.username) }}" class="text-lg font-medium text-blue-600 hover:underline">
            @{{ post.author.username }}
          </a>
          <div class="flex items-center mt-1">
            <span class="text-sm text-gray-500">{{ post.date }}</span>
            <span class="mx-2 text-gray-300">•</span>
            <span class="text-sm px-2 py-1 bg-gray-100 text-gray-700 rounded capitalize">{{ post.category }}</span>
          </div>
        </div>
      </div>
      
      <p class="text-gray-800 text-lg mb-6">{{ post.content }}</p>
      
      {% if post.image %}
        <img src="data:image/png;base64,{{ post.image }}" class="w-full max-h-96 object-contain mb-6 rounded">
      {% endif %}
      
      <!-- Like button would go here -->
      <div class="flex items-center text-gray-500">
        <button class="flex items-center focus:outline-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
            <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z" />
          </svg>
          <span>{{ post.likes|default(0, true) }} likes</span>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Comments section -->
  <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
    <div class="p-6">
      <h3 class="text-xl font-bold mb-6">Comments</h3>
      
      {% if current_user.is_authenticated %}
        <form method="POST" action="" class="mb-8">
          {{ form.csrf_token }}
          <div class="mb-4">
            {{ form.content(class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500", rows=3, placeholder="Add a comment...") }}
            {% if form.content.errors %}
              <div class="text-red-500 text-sm mt-1">
                {% for error in form.content.errors %}
                  {{ error }}
                {% endfor %}
              </div>
            {% endif %}
          </div>
          {{ form.submit(class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none") }}
        </form>
      {% endif %}
      
      <!-- Comments list -->
      {% if comments %}
        <div class="space-y-4">
          {% for comment in comments %}
            <div class="border-b pb-4">
              <div class="flex items-center mb-2">
                <a href="{{ url_for('posts.user_detail', username=comment.commenter.username) }}" class="font-medium text-blue-600 hover:underline">
                  @{{ comment.commenter.username }}
                </a>
                <span class="mx-2 text-gray-300">•</span>
                <span class="text-sm text-gray-500">{{ comment.date }}</span>
              </div>
              <p class="text-gray-800">{{ comment.content }}</p>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-gray-500 italic">No comments yet. Be the first to comment!</p>
      {% endif %}
    </div>
  </div>
  
  <div class="text-center">
    <a href="{{ url_for('posts.index') }}" class="text-blue-500 hover:underline">
      ← Back to Home
    </a>
  </div>
</div>
{% endblock %}
